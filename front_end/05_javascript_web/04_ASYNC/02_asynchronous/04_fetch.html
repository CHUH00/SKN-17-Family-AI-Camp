<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>fetch()</h1>

    <pre>
        - AJAX 외에 서버에 네트워크 요청을 보내고 받아올 수 있는 방법을 표준화한 api

        [ 기본 사용 방법 ]
        let promise = fetch(url, [options]);
        - url: 접근하고자 하는 url
        - options: 선택 매개변수로 http method, headers, body 내용을 객체로 지정 가능
                   (options를 지정하지 않으면 기본 GET 메서드로 요청)
    </pre>

    <script>
        async function callAPI() {
            const promise = fetch('https://jsonplaceholder.typicode.com/users');
            console.log(promise);
            // console.log(promise['[[PromiseResult]]']);   // 직접 접근 불가

            // 1. promise - then()
            // promise.then(response => {
            //     console.log(response);
            //     return response.json();
            // }).then(json => {
            //     console.log(json);
            // });

            // 2. async - await
            const response = await promise;
            console.log(response);

            console.log(`응답 상태: ${response.status}`);
            console.log(`응답 헤더: ${response.headers}`);
            console.log(`본문 내용 사용 여부: ${response.bodyUsed}`);

            // text(): 결과로 넘어온 json 문자열을 그대로 가진 promise 객체 반환
            // const responseText = await response.text();
            // console.log(responseText);
            // console.log(JSON.parse(responseText));

            // 응답을 1회 받아 body 내용을 확인한 후에는 응답 body 내용에 다시 접근 불가

            // json(): 결과로 넘어온 json 문자열을 파싱한 promise 객체 반환
            const responseJson = await response.json();
            console.log(responseJson);
        }

        callAPI();
    </script>
</body>
</html>